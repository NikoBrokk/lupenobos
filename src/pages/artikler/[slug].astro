---
import { getCollection } from "astro:content";

// Bygg alle statiske stier for artikler (samling: "articles")
export async function getStaticPaths() {
  const entries = await getCollection("articles");
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();

// Enkle helpers
const date = new Date(entry.data.pubDate);
const dato = date.toLocaleDateString("no-NO", {
  year: "numeric",
  month: "short",
  day: "numeric",
});
---

<main class="mx-auto max-w-3xl px-6 md:px-12 py-10">
  <header class="mb-8">
    <h1 class="text-3xl md:text-4xl font-semibold leading-tight">
      {entry.data.title}
    </h1>

    <div class="mt-2 text-sm opacity-70 flex flex-wrap items-center gap-x-3 gap-y-2">
      <time datetime={date.toISOString()}>{dato}</time>
      {entry.data.tag && <span>Â· {entry.data.tag}</span>}
      {Array.isArray(entry.data.categories) && entry.data.categories.length > 0 && (
        <ul class="flex flex-wrap gap-2">
          {entry.data.categories.map((c) => (
            <li class="rounded-full border border-white/15 px-2 py-0.5 text-xs opacity-80">{c}</li>
          ))}
        </ul>
      )}
    </div>

    {entry.data.image && (
      <img
        src={entry.data.image}
        alt={entry.data.title}
        class="rounded-2xl mt-6 w-full object-cover"
        loading="eager"
      />
    )}

    {entry.data.description && (
      <p class="mt-4 text-base opacity-90">{entry.data.description}</p>
    )}
  </header>

  <article class="prose prose-invert prose-headings:scroll-mt-24 max-w-none">
    <Content />
  </article>
</main>
